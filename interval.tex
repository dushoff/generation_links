
\documentclass[12pt]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}

\usepackage[colorinlistoftodos]{todonotes}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{biblatex}

\newcommand{\rR}{\mbox{$r$--$\cal R$}}
\newcommand{\RR}{\ensuremath{{\cal R}}}
\newcommand{\Rx}[1]{\ensuremath{{\cal R}_{#1}}} 
\newcommand{\Ro}{\Rx{0}}
\newcommand{\Reff}{\Rx{\mathit{eff}}}
\newcommand{\Tc}{\ensuremath{C}}

\newcommand{\eref}[1]{(\ref{eq:#1})}
\newcommand{\fref}[1]{Fig.~\ref{fig:#1}}
\newcommand{\Fref}[1]{Fig.~\ref{fig:#1}}
\newcommand{\sref}[1]{Sec.~\ref{#1}}
\newcommand{\frange}[2]{Fig.~\ref{fig:#1}--\ref{fig:#2}}
\newcommand{\tref}[1]{Table~\ref{tab:#1}}
\newcommand{\tlab}[1]{\label{tab:#1}}

\newcommand{\comment}[3]{\textcolor{#1}{\textbf{[#2: }\textit{#3}\textbf{]}}}
\newcommand{\jd}[1]{\comment{cyan}{JD}{#1}}
\newcommand{\swp}[1]{\comment{magenta}{SWP}{#1}}
\newcommand{\dc}[1]{\comment{blue}{DC}{#1}}
\newcommand{\jsw}[1]{\comment{red}{JSW}{#1}}

\addbibresource{refs.bib}
\usepackage{graphicx,grffile}

\setlength{\emergencystretch}{3em}  % prevent overfull lines

\title{Exploring how generation intervals link strength and speed of epidemics}
\author{Sang Woo Park \and David Champredon \and Joshua Weitz \and Jonathan Dushoff}
\date{\today: In preparation for \emph{PRSB}}

\begin{document}
\maketitle

\section*{Abstract}

Infectious-disease outbreaks are often characterized by the reproductive number \RR\ and exponential rate of growth $r$.
While an outbreak is ongoing, the rate of growth $r$ is often estimated directly from incidence data.
The reproductive number \RR\ is often of particular interest, because it provides information about how hard an outbreak will be to control, and about predicted final size.
During an outbreak \RR\ is typically estimated from $r$ by using information about generation intervals -- that is, the amount of time between when an individual is infected by an infector, and when that infector was infected.
In practice, it is impossible to obtain the exact shape of a generation-interval distribution and it is not always qualitatively clear how changes in estimates of the distribution translate to changes in the estimate of \RR.
Here, we show that parameterizing a generation interval distribution using its mean and variance provides a clear biological intuition into how its shape affects the relationship between \RR\ and $r$.
We explore approximations based on estimates of mean and variance, and a gamma approximation, and find that use of these two moments is often sufficient to capture the \rR\ relationship and provide robust estimates of \RR.

\section{Introduction}

Infectious disease research often focuses on estimating the reproductive number, i.e., the number of new infections caused on average by a single infection.
This number is termed the reproductive number -- \RR.
The reproductive number provides information about the disease's potential for spread and the difficulty of control.
It is described in terms of an average \cite{AndeMay91} or an appropriate sort of weighted average \cite{DiekHees90}.

The reproductive number has remained a focal point for research because it provides information about how a disease spreads in a population, on the scale of disease generations.
As it is a unitless quantity, it does not, however, contain information about \emph{time}.
Hence, another important quantity is the population-level \emph{rate of spread}, $r$. The initial rate of spread can often be measured robustly early in an epidemic, since the number of incident cases at time $t$ is expected to follow $i(t) \approx i(0) \exp(r t)$. The rate of growth can also be described using the ``characteristic time'' of exponential growth $\Tc = 1/r$. This is closely related to the doubling time (given by $T_2 = \ln(2) \Tc \approx 0.69 \Tc$).

In disease outbreaks, the rate of spread, $r$, is often inferred from case-incidence reports, by fitting an exponential function to the incidence curve \cite{MillRobi04, NishCast09, MaJDush14}.
\jsw{Talk about cumulative incidence?}
\jd{None of these cites use cumulative incidence, and the point about how maybe you can use it seems like a detour.}
Estimates of the initial exponential rate of spread, $r$, can then be combined with a mechanistic model that includes unobserved features of the disease to esimate the initial reproductive number, \RR.
In particular, $\RR$ is often calculated from $r$ and the generation-interval distribution using the generating function approach popularized by \cite{WallLips07}.

The \emph{generation interval} is the amount of time between when an individual is infected by an infector, and the time that the infector was infected \cite{Sven07}.
While $r$ measures the speed of the disease at the population level, the generation interval measures speed at the individual level.
Generation interval distributions are typically inferred from contact tracing, sometimes in combination with clinical data \cite{AylwBarb14,LessOtt16,HubeJohn16}.
Generation interval distributions can be difficult to ascertain empirically, and the generation-function approach depends on entire distribution -- which makes it difficult to ascertain which features of the distributions are essential to connect measurements of the rate of spread $r$, with the reproductive number, \RR.

Here, we explore the qualitative relationship between generation time, initial rate of spread $r$, and initial reproductive number \RR\ using means, variance measures and approximations.
By doing so, we hope to shed light on the underpinnings of the relationship between $r$ and \RR, and on the factors underlying its robustness and its practical use when data on generation intervals is limited or hard to obtain.

\section{Relating \RR\ and $r$}

\begin{figure}[htbp] \centering
	% 
	\includegraphics[width=1.0\textwidth]{link_calculations/steps.pdf}
	\caption{Two hypothetical epidemics with the same growth rate ($r=0.25/\mathrm{week}$) and fixed generation intervals.  Assuming a short generation interval (fast transmission at the individual level) implies a smaller reproductive number $\Ro$ (panel A) when compared to a longer generation interval (slow transmission at the individual level, panel B). 
% {(For calculations, we assumed, generation intervals were fixed.)} 
	\label{fig:link}}
\end{figure}

We are interested in the relationship between $r$, \RR~and the generation-interval distribution, which describes the interval between the time an individual becomes \emph{infected} and the time that they \emph{infect} another individual.
This distribution links $r$ and \RR. In particular, if \RR~is known, a shorter generation interval means a faster epidemic (larger $r$). Conversely (and perhaps counter-intuitively), if $r$ is known, then faster disease generations imply a \emph{lower} value of \RR, because more \emph{individual} generations are required to realize the same \emph{population} spread of disease~(see \fref{link}).

We define the generation-interval distribution using a renewal-equation approach.
A wide range of disease models can be described using the model: 
\begin{equation}
i(t) = S(t)\int{K(s)i(t-s) \,ds},
\label{eq:Renewal}
\end{equation}
\cite{Hees,ChampInPrep}
where $t$ is time, $i(t)$ is the incidence of new infections, $S(t)$ is the \emph{proportion} of the population susceptible, and $K(s)$ is the intrinsic infectiousness of individuals who have been infected for a length of time $s$.

We then have the basic reproductive number: 
\begin{equation}
\Ro = \int{K(s)ds},
\end{equation}
and the \emph{intrinsic} generation-interval distribution:
\begin{equation}
g(s) = \frac{K(s)}{\Ro}.
\end{equation}
The ``intrinsic'' interval can be distinguished from ``realized'' intervals, which can look ``forward'' or ``backward'' in time \cite{ChamDush15} (see also earlier work \cite{Sven07,Nish10}).

Disease growth is predicted to be approximately exponential in the early phase, because the depletion in the effective number of susceptibles is relatively small.
Thus, for the exponential phase, we write:
\begin{equation}
i(t) = \RR\int{g(\tau)i(t-\tau) \,d\tau},
\end{equation}
where $\RR = \Ro S$.

We then solve for the characteristic time $\Tc$ by assuming that the population is growing exponentially: i.e., substitute $i(t) = i(0) \exp(t/\Tc)$ to obtain
\begin{equation}
	1/\RR = \int{g(\tau)\exp(-\tau/\Tc) \,d\tau}.\label{eq:Euler}
\end{equation}

This fundamental relationship dates back to the work of Euler \cite{Euler}.
We will explore the shape of this relationship using parameters based on some human infectious diseases, and investigate approximations based on gamma-distributed generation intervals.

\section{Approximation framework}

\subsection{Approximation method, theory}

We do not expect to know the full distribution $g(\tau)$, so we are interested in approximations to \RR\ based on limited information.
We follow the approach of \cite{NishCast09} and approximate the generation interval with a gamma distribution.
This is a better-grounded starting point than the earlier normal-distribution approach of \cite{WallLips07}, since the gamma distribution is confined to non-negative values (see Appendix for comparisons).

For biological interpretability, we describe the distribution using the mean $\bar G$ and the squared coefficient of variation $\kappa$ (thus $\kappa = 1/a$, and $\bar G = a\theta$, where $a$ and $\theta$ are the shape and scale parameters under the standard parameterization of the gamma distribution).
Substituting the gamma distribution into \eref{Euler} then yields:
\begin{equation}
	\RR \approx (1 + \kappa r \bar G)^{1/\kappa}.
	\label{eq:gamApp}
\end{equation}

We write:
\begin{equation}
	\RR \approx (1 + \kappa \rho)^{1/\kappa} \equiv X(\rho; 1/\kappa),
	\label{eq:genExp}
\end{equation}
where $\rho = \bar G/\Tc = r\bar G$ measures how fast the epidemic is growing (on the time scale of the mean generation interval) -- or equivalently, the length of the mean generation interval (in units of the characteristic time of exponential growth).
The longer the generation interval is compared to $T_c$, the higher the estimate of $\RR$ (see \fref{link}).
We then explore the behaviour of the generalized exponential function $X$ defined above (equivalent to the Tsallis ``q-exponential'', with $q=1-\kappa$ \cite{tsallis1994numbers}): its shape determines how the estimate of $\RR$ changes with the estimate of normalized generation length $\rho$.

\begin{figure}[htbp]
	\centering \includegraphics[width=1.0\textwidth]{link_calculations/genExp.pdf}
	\caption{
		The approximate relationship \eref{gamApp} between mean
		generation time (relative to the characteristic time of
		exponential growth, $\rho = r \bar G = \bar G/\Tc$)
		and reproductive number.
		The curves correspond to different
		amounts of variation in the generation-interval
		distribution. 
	} \label{fig:genExp} 
\end{figure}

\jsw{Okay!  But, for readability, why do you need to define this as X.  By defining in terms of X you have sentences like \ldots}
\jd{I see the point, but I don't think that's much abstraction. R is approximated by the function X, and we're investigating how X behaves. I have changed the text a bit to try to get this idea across.}
For small $\rho$, $X$ always looks like $1+\rho$, regardless of the shape parameter $1/\kappa$, which determines the curvature: if $1/\kappa = 1$, we get a straight line, for $1/\kappa=2$ the curve is quadratic, and so on (see \fref{genExp}).
For large values of $1/\kappa$, $X$ converges toward $\exp(\rho)$.
\jsw{specify this using a formula, don't just allude to the compound interest approximation to the exponential. Just go ahead and specify it.}
\jd{I thought about this, but it would look just like the formula for X \ldots I just simplified}

The limit as $\kappa\to 0$ is reasonably easy to interpret. The incidence is increasing by a factor of $\exp(\rho)$ in the time it takes for an average disease generation. If $\kappa=0$, the generation interval is fixed, so the means the average case must cause $\RR = \exp(\rho)$ new cases.
If variation in the generation time (i.e., $\kappa$) increases, then some new cases will be produced before, and some after, the mean generation time.
Since we assume the disease is increasing exponentially, infections that occur early on represent a larger proportion of the population, and thus will have a disproportionate effect: individuals don't have to produce as many lifetime infections to sustain the growth rate, and thus we expect  $\RR < \exp(\rho)$.

The straight-line relationship for $\kappa=1$ also has a biological interpretation. 
In our approximation, this corresponds to a generation distribution that is approximated by an exponential distribution. 
In this case, recovery rate and infection rate are constant for each individual.
The rate of exponential growth per generation is then given directly by the net per capita increase in infections: $\RR-1$, where one represents the recovery of an infectious individual. 

\subsection{Approximation method, in practice}

We test our approximation method by generating pseudo-realistic generation-interval distributions, using observations (or estimated parameters) of generation intervals (or else latent and infectious intervals) from specific diseases. 
For each pseudo-realistic distribution, we calculate the ``true'' relationship between $r$ and \RR\ based on our distribution assumptions, and compare it with one or more distributions based on gamma approximations. 
These approximations are first done with large amounts of data, allowing us to evaluate how well the approximations describe the \rR\ relationship under ideal conditions, and then tested with smaller amounts of data. 

Estimating generation intervals is complex; our goal with pseudo-realistic distributions is not to precisely match real diseases, but to generate distributions that are likely to be roughly as challenging for our approximation methods as real distributions would be.
To generate generation intervals we sample from observations (for empirical distributions) or generate from uniform quantiles (for parametric distributions). We sample latent periods at random.
We then choose infectious periods by length-weighted resampling (since longer infectious period implies more opportunities to infect), then choose infection delays uniformly within resampled infectious periods. Generation interval is the sum of latent period and infection delay \cite{HampDush09}.  
For our examples, we drew 10000 values from each distribution. 

We then calculate ``exact'' relationships (for our pseudo-realistic distributions) by substituting sampled generation intervals into \eref{Euler}.
This relationship is then compared to the approximate relationship based on \eref{gamApp}

\section{Examples}

We investigate this approximation approach using three different examples. 
These examples also serve to demonstrate that robust estimates could be made with less data and potentially earlier in an outbreak -- a point we revisit in the Discussion.
Our initial investigation of this question was motivated by our work on the West African Ebola Outbreak \cite{WeitDush15}, so we start with that example. To probe the approximation more thoroughly, we also chose one disease with high variation in generation interval (canine rabies), and one with a high reproductive number (measles). For simplicity, we assumed that latent and infectious periods are equivalent to incubation and symptomatic periods for Ebola virus disease (EVD) and canine rabies.

\subsection{Ebola}
\label{EbolaEx}

\begin{figure}[htbp] \centering
	\includegraphics[width=1.0\textwidth]{link_calculations/ebola.pdf}
	\caption{Estimating \RR~for the West African Ebola Outbreak.
(solid curve) The relationship between growth rate and \RR~using a realistic generation-interval distribution based on \cite{AylwBarb14}.
(dashed curve) The same relationship, approximated using the observed mean and CV. 
(dotted curves) Naive approximations based on exponential (lower) and fixed (upper) generation distributions.
Points indicate estimates for the three focal countries of the West African Ebola Outbreak calculated by \cite{AylwBarb14}: {Sierra Leone (square, $\RR=1.38$), Liberia (triangle, $\RR=1.51$), and Guinea (circle, $\RR=1.81$).} Initial growth rate for each outbreak was inferred from doubling periods reported by \cite{AylwBarb14} ($r = \ln(2)/T_2$).
	\label{fig:EbolaCurve}}
\end{figure}

We generated a pseudo-realistic generation-interval distribution for Ebola virus disease (EVD) using information from \cite{AylwBarb14} and a lognormal assumption for both the incubation and infectious periods.
We used a lognormal assumption for our components because it is straightforward and should provide a challenging test of our gamma approximation. 
We used the reported standard deviation for the infectious period, and chose the standard deviation for the incubation period to match the reported standard deviation for the serial interval distribution, since this value is available and is expected to be similar to the generation interval distribution for EVD \cite{AylwBarb14}.

We then calculated the exact relationship between $r$ and $\RR$ implied by our pseudo-realistic distribution \eref{Euler}, and the approximate relationship \eref{gamApp} based only on the mean and CV (see \fref{EbolaCurve}). The approximation is within 1\% of the pseudo-realistic distribution it is approximating across the range of country estimates, and within 5\% across the range shown. It is also within 2\% of the WHO estimates, which were done using a different approach. 

\jsw{What do you mean "simulated"... a distribution. The reader expects you are using real data... and will be concerned that you are doing gamma in gamma out.}
\jd{I have been working hard on the language about simulated distributions, let me know what you think.}
\jd{We explain that we picked a lognormal to make sure it was different. I'm pretty sure that last time you suggested that we not mess with the lognormal (that is, you suggested that we \emph{should} do gamma in/gamma out, which is not actually stupid, but would probably be confusing.}
\jd{Using an estimate from observed intervals might in fact be possible, but raises issues that I might rather deal with in another paper.}

\subsection{Measles}
\label{MeaslesEx}

\begin{figure}[htbp] \centering
	\includegraphics[width=1.0\textwidth]{link_calculations/measles.pdf}
	\caption{Estimating \RR~for measles.
		(solid curve) the relationship between growth rate and \RR~using a realistic generation-interval distribution.
		(dashed curve) the same relationship approximated using the estimated mean and CV (this curve is almost invisible because it overlaps the solid curve)
		The dotted curves show the approximations based on exponential (lower) and fixed (upper) generation distributions.
		Gray horizontal lines represent \RR\ ranges: 12.5-18 \cite{anderson1982directly}.
	}
	\label{fig:measlesCurve}
\end{figure}

We also applied the moment approximation to a pseudo-realistic generation-interval distribution based on information about measles from \cite{LessReic09}, \cite{Lloy01}, and \cite{anderson1982directly}. 
Here, we found surprisingly close agreement between the exact and approximate relationships between $r$ and \RR\ across a much wider range of interest (a difference of $<1\%$ for \RR\ up to $>20$).
On examination, this closer agreement is due to the smaller overall variation in generation times in measles: when overall variation is small, differences between distributions have less effect.

\subsection{Rabies}

\begin{figure}[htbp] \centering
	\includegraphics[width=1.0\textwidth]{link_calculations/rabies.pdf}
	\caption{(Left) estimating \RR~from rabies infectious case data.
		(solid curve) the relationship between growth rate and \RR~using a realistic generation-interval distribution.
		(dashed curve) the same relationship approximated using the observed mean and CV.
		(dash-dotted curve) the same relationship approximated using the mean and CV calculated from a maximum-likelihood fit.
		The dotted curves show the approximations based on exponential (lower) and fixed (upper) generation distributions.
		Gray horizontal lines represent \RR\ ranges estimated by \cite{HampDush09}: 1.05 - 1.32.
		(Right) histogram represents rabies generation interval distributions simulated from incubation and infectious periods observed by \cite{HampDush09}.
		Curves represent estimated distribution of generation intervals using method of moments and MLE (corresponding to approximate $r-\RR$ relationships of the left figure).
	}
	\label{fig:rabiesCurve}
\end{figure}

We did a similar analysis for rabies, and found that approximation is generally harder for this high-variance case (see \fref{rabiesCurve}). Since rabies estimates point to a value of \RR\ near 1, results are not very sensitive to any tested assumption about the relationship. But, looking at the relationship more broadly, we see that the moment-based approximation would do a poor job of predicting the relationship for intermediate or large values of \RR\ -- in fact, a poorer job than if we use the approximation based on exponentially distributed generation times. 

The reason for this can be seen in the histogram shown in \fref{rabiesCurve}. The moment approximation is strongly influenced by rare, very long generation intervals, and does a poor job of matching the observed pattern of short generation intervals (in particular, the moment approximation misses the fact that the distribution has a density peak at a finite value). We expect short intervals to be particularly important in driving the speed of the epidemic, and therefore in determining the relationship between $r$ and \RR. We can address this problem by estimating gamma parameters formally using a maximum-likelihood fit to the pseudo-realistic generation intervals. This fit does a better job of matching the observed pattern of short generation intervals and of predicting the simulated relationship between $r$ and \RR\ across a broad range (\fref{rabiesCurve}).

\begin{table}[h!]
\centering
\begin{tabular}{l*{3}{c}}
\hline
Disease & Ebola & Measles & Rabies\\
\hline
Parameter & \multicolumn{3}{c}{Values}\\
\hline
Reproduction number & 1.38, 1.51, 1.81 \cite{AylwBarb14} & 12.5-18 \cite{anderson1982directly} & 1.05-1.32 \cite{HampDush09} \\
Mean incubation period (days) & 11.4 \cite{AylwBarb14} & 12.77 \cite{LessReic09}  & 24.24 \cite{HampDush09} \\
SD incubation period (days) & 7.5 (see \sref{EbolaEx}) & 2.67 \cite{LessReic09} & 29.49 \cite{HampDush09} \\
Mean infectious period (days) & 5 \cite{AylwBarb14} & 6.5 \cite{anderson1982directly} & 3.57 \cite{HampDush09} \\
SD infectious period (days) & 4.7 \cite{AylwBarb14} & 2.9 \cite{Lloy01} & 2.26 \cite{HampDush09}
\end{tabular}
\caption{Parameters that were used to obtain theoretical generation distributions for each disease. Reproduction numbers are represented as points in figure \frange{EbolaCurve}{rabiesCurve}.}
\tlab{parameters}
\end{table}

\section{Discussion}

Estimating the reproductive number \RR\ is a key part of characterizing and controlling infectious disease spread. The initial value of \RR\ for an outbreak is often estimated by estimating the initial exponential rate of growth, and then using a generation-interval distribution to relate the two quantities \cite{WallLips07,Sven07,Nish10,Sven15}.
However, detailed estimates of the full generation interval are difficult to obtain, and the link between uncertainty in the generation interval and uncertainty in estimates of \RR\ are often unclear.
Here we introduced and analyzed simple framework for \emph{estimating} the relationship between \RR\ and $r$, using only the estimated mean and CV of the generation interval. The framework is based on the gamma distribution. We use examples to test the robustness of the framework. We also compare estimates based directly on estimated mean and variance of of the generation interval to estimates based on maximum-likelihood fits.

The gamma approximation for calculating \RR\ from $r$ was introduced by \cite{NishCast09}, and  provides estimates that are simpler, more robust and more realistic than those from the normal approximations developed by \cite{WallLips07} (see Appendix).
Here, we attempted to present the gamma approximation in a form conducive to intuitive understanding of the relationship between speed, $r$, and strength, \RR\ (See~\fref{genExp}).
We discuss the general result that estimates of \RR\ increase with mean generation, but decrease with \emph{variation} in generation times \cite{WallLips07}. 
We also provide mechanistic interpretations: when generation intervals are longer, more infection is needed per generation (larger \RR)  in order to produce a given rate of increase $r$. Similarly, when variance in generation time is low, there is less early infection, and thus slower exponential growth, also meaning that a larger \RR\ is needed. 

We tested the gamma approximation framework by applying it to parameter regimes based on three diseases: Ebola, measles, and rabies. 
We found that approximation based on observed moments gives good estimates when the generation-interval distribution is not too broad (as is the case for Ebola and measles, but not for rabies, see \tref{parameters}), but that using maximum likelihood to estimate the moments provides better estimates for a broader range of parameters, and also when data are limited (see Appendix). \jsw{Wishy washy (particularly ``good'')}.

Our key finding is that summarizing an entire generation interval distribution with its moments can give sensible and robust estimates.
This framework has potential advantages for understanding the likely effects of parameter changes, and also for parameter estimation with uncertainty: since \RR\ can be estimated from three simple quantities ($\bar G$, $\kappa$ and $r$), it should be straightforward to propagate uncertainty from estimates of these quantities to estimates of \RR.

For example, during the Ebola outbreak in West Africa, many researchers tried to estimate \RR\ from $r$ \cite{Alth14, AylwBarb14, NishChow15, RiveLofg14, 
KingDome15} but uncertainty in the generation-interval distribution was often neglected (but see \cite{TaylDush16}).  
During the outbreak, \cite{WeitDush15} used a generation-interval argument to  show that neglecting the effects of post-burial transmission would be expected to lead to underestimates of \RR.
Our generation interval framework provides a clear interpretation of this result: as long as post-burial transmission tends to increase generation intervals, it should result in higher estimates of \RR\ for a given estimate of $r$.
Knowing the exact shape of the generation interval distribution is difficult, but quantifying how various transmission routes and epidemic parameters affect the moments of the generation interval distribution will help researchers better understand and predict the scope of future outbreaks.

\subsection*{Acknowledgments}

\printbibliography

\clearpage

\section{Appendix}

\input{appendix.tex}

\end{document}
